# 26. 日志

Spring Boot使用[Commons Logging](http://commons.apache.org/proper/commons-logging/)记录所有的内部日志，但是开放了底层的日志实现。提供了对[Java Util Logging](https://docs.oracle.com/javase/8/docs/api//java/util/logging/package-summary.html),[Log4J2](http://logging.apache.org/log4j/2.x/)和[Logback](http://logback.qos.ch/)的默认实现。在每个logger中都预先配置使用控制台作为输出，同时也可用可选的文件输出。

默认情况下，如果使用`Starters`，Logback将作为日志。也要包含恰当的Logback规则来保证依赖库使用Java Util Logging，Commons Logging，Log4J或SLF4J都能正确工作。

> **小贴士**
> 
> 有很多Java可用的日志框架。不必担心上面的清单看起来有些混乱。通常，你不必更换你的日志依赖，Spring Boot在默认配置下能很好的工作。

## 26.1 日志格式化

Spring Boot默认的日志输出看上去如下所示：

```java
2014-03-05 10:57:51.112  INFO 45469 --- [           main] org.apache.catalina.core.StandardEngine  :
 Starting Servlet Engine: Apache Tomcat/7.0.52
2014-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       :
 Initializing Spring embedded WebApplicationContext
2014-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.s.web.context.ContextLoader            :
 Root WebApplicationContext: initialization completed in 1358 ms
2014-03-05 10:57:51.698  INFO 45469 --- [ost-startStop-1] o.s.b.c.e.ServletRegistrationBean        :
 Mapping servlet: 'dispatcherServlet' to [/]
2014-03-05 10:57:51.702  INFO 45469 --- [ost-startStop-1] o.s.b.c.embedded.FilterRegistrationBean  :
 Mapping filter: 'hiddenHttpMethodFilter' to: [/*]
```

下面是输出项：

- 日志和时间：精确到毫秒并且很容易排序
- 日志级别：`ERROR`,`WARN`,`INFO`,`DEBUG`或者`TRACE`
- 进程ID
- `---`分隔符来区分真正的日志信息输出
- 线程名称：用方括号包裹(在控制台输出中经常是被截断的)
- 日志名称：通常是源码类名称(经常为简写形式)
- 日志信息

> **注意**
> 
> Logback没有`FATAL`级别。是被映射到`ERROR`上的。

## 26.2 控制台输出

默认的日志配置会将日志信息输出到控制台。默认情况下，`ERROR`级别，`WARN`级别，和`INFO`级别都会被记录。你可以通过在启动程序时添加一个`--debug`标志来开启`debug`模式。

```bash
$ java -jar myapp.jar --debug
```

> **注意**
> 
> 你也可以在`application.properties`中指定`debug=true`来实现。

当开了debug模式后，将会配置一系列内核日志记录(内置容器，Hibernate，和Spring Boot)来输出更多的信息。开启debug模式不会将你的应用设置为输出所有的`DEBUG`级别的信息。

或者，你可以通过在启动程序时添加一个`--trace`标志(或在`application.properties`中设置`trace=true`)。这样做会开启一系列核心日志记录logger（嵌入式容器，Hibernate模式生成和整个Spring文件夹）启用trace日志。

### 彩色编码输出

如果你的终端输出支持ANSI,颜色输出会有助提高可读性。你可以通过设置`spring.output.ansi.enable`为[可用值]()来覆写自动检测。

d颜色编码可以通过使用`@clr`约定名词来配置。最简单的形式是根据日志级别进行颜色输出，例如：

| 级别 | 颜色 |
|------|------|
|FATAL|红色|
|ERROR	|红色|
|WARN	|黄色|
|INFO	|绿色|
|DEBUG	|绿色|
|TRACE	|绿色|

或者，你可以通过在转换器中提供选项来指定应该使用的颜色或样色。例如，为了使文本显示黄色，你可以使用以下配置：

```bash
$ clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){yellow}
```

以下颜色和样式被支持：

- `blue`-蓝色
- `cyan`-青色
- `faint`-
- `green`-绿色
- `magenta`-品红
- `red`-红色
- `yellow`-黄色

## 26.3 文件输出

















































