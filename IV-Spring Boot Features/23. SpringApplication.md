# 23. SpringApplication

`SpringApplication`类提供了构建Spring应用的简便方式，只需要从`main()`方法启动应用即可。在很多场景下，你可以将应用托管给`SpringApplication.run`静态方法，如下样例代码所示：

```java
public static void main(String[] args) { 
	SpringApplication.run(MySpringConfiguration.class, args);
}
```

应用启动后，你应该可以看到类似下面的输出：

```bash
  .   ____          _            __ _ _
   /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
  ( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
   \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
    '  |____| .__|_| |_|_| |_\__, | / / / /
   =========|_|==============|___/=/_/_/_/
   :: Spring Boot ::   v2.0.0.RELEASE
  2013-07-31 00:08:16.117  INFO 56603 --- [
   Starting SampleApplication v0.1.0 on mycomputer with PID 56603 (/apps/myapp.jar started by pwebb)
  2013-07-31 00:08:16.166  INFO 56603 --- [           main]
   ationConfigServletWebServerApplicationContext : Refreshing
   org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@6e5a8246:
   startup date [Wed Jul 31 00:08:16 PDT 2013]; root of context hierarchy
  2014-03-04 13:09:54.912  INFO 41370 --- [           main] .t.TomcatServletWebServerFactory : Server
   initialized with port: 8080
  2014-03-04 13:09:56.501  INFO 41370 --- [           main] o.s.b.s.app.SampleApplication            :
   Started SampleApplication in 2.992 seconds (JVM running for 3.658)
```

默认设置会显示`INFO`日志信息，包含一些相关的启动细节，例如启动应用的用户。如果你需要除了`INFO`之外的日志级别信息，可以查阅[Section 26.4,"Log Levels"]()

## 23.1 启动失败

如果你的应用启动失败，注册过的`FailureAnalyzers`类会提供一个结构良好的错误信息以及具体的修复操作。例如，如果你启动的web应用端口未8080，而该端口被占用了，你会看到如下信息：

```bash
***************************
APPLICATION FAILED TO START
***************************
Description:

Embedded servlet container failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.
```

> **注意**
> 
> Spring Boot提供了很多`FailureAnalyzer`接口实现，你可以从[这里找到-73.1 ]()

如果没有失败分析类没能处理异常，程序仍然会显示完整的，更易于理解的错误报告。为实现此效果，你必须[开启debug属性]()或者开启`org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener`的[DEBUG日志功能]()

例如，如果你通过`java -jar`方式运行程序，你可以按照下面方法启用debug属性：

```bash
$ java -jar myproject-0.0.1-SNATSHOT.jar --debug
```

## 23.2 自定义Banner

启动时的日志banner标题可以通过在classpath中添加一个`banner.txt`文件，或者设置`spring.banner.location`属性指定`banner.txt`的路径来修改。如果该文件不是由UTF-8编码的，你可以通过设置`spring.banner.charset`属性来修改。除了文本格式以外，你也能添加`banner.gif,banner.jpg`或者`banner.png`图片文件在你的classpath中或者通过设置`spring.banner.location`属性指定`banner.txt`的路径来指定文件位置。图片会被转换为ASCII编码形式，并展示在文本banner标题上面。

在`banner.txt`文件中，你可以使用如下任意一个占位符：

![2018033015224086242598.png](http://o9zsp3mn8.bkt.clouddn.com/2018033015224086242598.png)

> **小贴士**
> 
> 如果你希望通过编码方式设置banner标题，可以使用`SpringApplication.setBanner(...)`方法来设置。请使用`org.springframework.boot.Banner`接口并实现自己的`pringBanner()`方法即可。

你也可以设置`spring.main.banner-mode`属性来决定banner标题是否在`System.out`(控制台) 上展示，发送给指定的logger(log)，或者根本就不生成.(off)

打印的banner标题会被注册为`springBootBanner` 下的一个单例。

> **注意**
> 
> YAML 将`off`映射为`false`，所以请在禁用banner的时候，务必打上双引号,如下所示：
> 
> spring:
> 	main:
>   banner-mode: "off"

## 23.3 自定义SpringApplication

如果默认的`SpringApplication`配置不是你的菜，你可以创建一个本地示例并且自定义它。例如，想要禁用banner，你可以这样写：

```java
public static void main(String[] args) {

	SpringApplication app = new SpringApplication(MySpringConfiguration.class); 
	app.setBannerMode(Banner.Mode.OFF);
	app.run(args);
	
}
```

> **注意**
> 
> 传送给`SpringApplication`的构造器参数是Spring beans类的配置源。在大多数情况下，这些类都会引用`@Configuration`类，但他们也可以引用XML配置或者扫描的包。

我们也可以使用`application.properties`来配置`SpringApplication`。详情请见[24. 外部化配置]()

## 23.4 Fluent Builder API






























































